{% extends 'base.html' %}
{% block title %}Registrar Pr√©stamo{% endblock %}

{% block content %}
<div class="d-flex flex-column gap-3">
    <div>
        <h2 class="text-accent fw-semibold mb-2">Registrar pr√©stamo</h2>
        <p class="card-main-lead mb-0">
            Completa los campos para registrar un nuevo pr√©stamo de materiales.
        </p>
    </div>

    {% if mensaje %}
        <div class="alert alert-success mt-2 py-2">‚úÖ {{ mensaje }}</div>
    {% endif %}
    {% if error %}
        <div class="alert alert-danger mt-2 py-2">‚ö†Ô∏è {{ error }}</div>
    {% endif %}

    <form method="post" class="mt-2 p-3">
        {% csrf_token %}
        <div class="mb-3">
            {{ form.as_p }}
        </div>
        <div class="d-flex flex-wrap gap-2 mt-3">
            <button class="btn btn-success px-4" type="submit">üíæ Registrar</button>
            <a class="btn btn-outline-light px-4" href="{% url 'prestamo_list' %}">Ver pr√©stamos</a>
        </div>
    </form>

    <hr class="my-4" style="border-color: rgba(148,163,184,0.3);">

    <div class="mt-4">
        <h4 class="text-accent mb-3">Stock actual de materiales</h4>
        <table class="table table-sm table-dark table-striped">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Nombre</th>
                    <th>Stock</th>
                </tr>
            </thead>
            <tbody>
                {% for m in materiales %}
                    <tr>
                        <td>{{ m.id }}</td>
                        <td>{{ m.nombre }}</td>
                        <td>{{ m.stock }}</td>
                    </tr>
                {% empty %}
                    <tr><td colspan="3">No hay materiales registrados.</td></tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}
